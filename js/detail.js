"use strict";var _createClass=function(){function i(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,a){return e&&i(t.prototype,e),a&&i(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}require(["./config"],function(){require(["jquery","template","loadHF","fly","zoom"],function(r,i){new(function(){function t(){_classCallCheck(this,t),this.cart=JSON.parse(localStorage.getItem("cart"))||[],this.init(),this.addListener()}return _createClass(t,[{key:"init",value:function(){var t="http://www.xiongmaoyouxuan.com/api/detail?id="+window.location.search.slice(4);r.getJSON(t,function(t){var e=t.data.detail,a=i("detail-template",{prod:e});r(".detail_box").prepend(a),r("img.prod-img").elevateZoom({gallery:"gallery",cursor:"pointer",galleryActiveClass:"active",tint:!0,tintColour:"#F90",tintOpacity:.5})})}},{key:"addListener",value:function(){r(".detail_box").on("click",".form-add-to-cart input:submit",this.addToCartHandler.bind(this))}},{key:"addToCartHandler",value:function(t){t.preventDefault();var e=r(t.target).parents(".prod-detail"),a={id:e.data("id"),title:e.find(".prod-title").text(),image:e.find(".prod-img").attr("src"),price:e.find(".prod-price").text(),amount:1};this.cart=JSON.parse(localStorage.getItem("cart"))||[],this.cart.some(function(t){return t.id==a.id})?this.cart=this.cart.map(function(t){return t.id==a.id&&(t.amount+=1),t}):this.cart.push(a),localStorage.setItem("cart",JSON.stringify(this.cart)),this.fly(t)}},{key:"fly",value:function(t){var e={top:t.pageY,left:t.pageX},a=r(".bag").offset(),i=r(".prod-img").attr("src");r('<img src="'+i+'" style="width: 40px;">').fly({start:e,end:a,onEnd:function(){this.destroy()}})}}]),t}())})});