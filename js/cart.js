"use strict";var _createClass=function(){function a(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}require(["./config"],function(){require(["jquery","template","loadHF"],function(n,e){new(function(){function t(){_classCallCheck(this,t),this.cart=JSON.parse(localStorage.cart)||[],this.initCart(),this.addListener()}return _createClass(t,[{key:"initCart",value:function(){if(0!==this.cart.length){n(".cart-empty").hide().next().removeClass("hidden");var t=e("cart-template",{cart:this.cart});n(".cart-body").html(t)}else n(".cart-empty").show().next().hide()}},{key:"addListener",value:function(){n(".cart-body").on("click",".del",this.removeHandler.bind(this)),n(".cart-body").on("click",".increment, .decrement",this.modifyHandler.bind(this)),n(".cart-body").on("blur",".prod-amount",this.modifyHandler.bind(this)),n(".chk_all").on("click",this.checkAllHandler.bind(this)),n(".cart-body").on("click",".chk-prod",this.checkProductHandler.bind(this))}},{key:"removeHandler",value:function(t){var e=n(t.target).parents("tr"),r=e.data("id");this.cart=this.cart.filter(function(t){return t.id!=r}),localStorage.cart=JSON.stringify(this.cart),e.remove(),this.calcTotalPrice()}},{key:"modifyHandler",value:function(t){var e=n(t.target).parents("tr"),r=e.data("id"),a=this.cart.find(function(t){return t.id==r});if(n(t.target).is(".increment"))a.amount+=1;else if(n(t.target).is(".decrement")){if(a.amount<=1)return;a.amount-=1}else if(n(t.target).is(".prod-amount")){var c=n(t.target).val();if(!/^[1-9]\d*$/.test(c))return void n(t.target).val(a.amount);a.amount=Number(c)}localStorage.cart=JSON.stringify(this.cart),e.find(".prod-amount").val(a.amount),e.find(".sub").text((a.amount*a.price).toFixed(2)),this.calcTotalPrice()}},{key:"checkAllHandler",value:function(t){var e=n(t.target).prop("checked");n(".chk-prod").prop("checked",e),this.calcTotalPrice()}},{key:"checkProductHandler",value:function(t){n(".chk_all").prop("checked",n(".chk-prod:checked").length===this.cart.length),this.calcTotalPrice()}},{key:"calcTotalPrice",value:function(){var r=0;n(".chk-prod:checked").each(function(t,e){r+=Number(n(e).parents("tr").find(".sub").text())}),n(".total-price").text(r.toFixed(2))}}]),t}())})});